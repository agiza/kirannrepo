id = params.get('id');
nestedPath = params.get('nestedPath');
Object[] nestedContextPath;

def update(nestedContextPath) {
	for (int i = 0; i < nestedContextPath.size(); i++){		
		if (nestedContextPath[i].id == id) {
			nestedContextPath.remove(i);
			i = nestedContextPath.size(); 	
		}
	}
}

if (nestedPath.size() == 1) {
	nestedContextPath = ctx._source[nestedPath.get(0)];	
} else if (nestedPath.size() == 2) {
	nestedContextPath = ctx._source[nestedPath.get(0)][nestedPath.get(1)];	
} else if (nestedPath.size() == 3) {
	nestedContextPath = ctx._source[nestedPath.get(0)][nestedPath.get(1)][nestedPath.get(2)];	
} else if (nestedPath.size() == 4) {
	nestedContextPath = ctx._source[nestedPath.get(0)][nestedPath.get(1)][nestedPath.get(2)][nestedPath.get(3)];	
} else if (nestedPath.size() == 5) {
	nestedContextPath = ctx._source[nestedPath.get(0)][nestedPath.get(1)][nestedPath.get(2)][nestedPath.get(3)][nestedPath.get(4)];	
} else if (nestedPath.size() == 6) {
	nestedContextPath = ctx._source[nestedPath.get(0)][nestedPath.get(1)][nestedPath.get(2)][nestedPath.get(3)][nestedPath.get(4)][nestedPath.get(5)];	
} else if (nestedPath.size() == 7) {
	nestedContextPath = ctx._source[nestedPath.get(0)][nestedPath.get(1)][nestedPath.get(2)][nestedPath.get(3)][nestedPath.get(4)][nestedPath.get(5)][nestedPath.get(6)];	
}
update(nestedContextPath);

