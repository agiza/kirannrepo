# mongo.conf
<% if @app_name == "mongod" -%>
# Mongod Master configuration
pidfilepath = /var/run/mongo/mongod.pid
logpath=/var/log/mongo/mongod.log

logappend=true

<% if node.attribute?('mongodblog') -%>
quiet = false
<% else -%>
quiet = true
<% end -%>

# fork and run in background
fork = true

bind_ip = 127.0.0.1,<%= node[:ipaddress] %>
port = 27017

# slave = <%= @mongodbreplica %>

dbpath=/data/db
replSet = rdng

shardsvr = true

# master = true

<% end -%>
<% if @app_name == "mongod-replica" -%>
# Mongod replica configuration
pidfilepath = /var/run/mongo/mongod-replica.pid
logpath=/var/log/mongo/mongod-replica.log

logappend=true

<% if node.attribute?('mongodblog') -%>
quiet = false
<% else -%>
quiet = true
<% end -%>

# fork and run in background
fork = true

bind_ip = 127.0.01,<%= node[:ipaddress] %>
port = 27027

dbpath=/data/db/replica
#slave = true
#source = <%= @mongodbmaster %>

replSet = rdng
<% end -%>
<% if @app_name == "mongod-replica1" -%>
# Mongod replica configuration
pidfilepath = /var/run/mongo/mongod-replica1.pid
logpath=/var/log/mongo/mongod-replica1.log

logappend=true

<% if node.attribute?('mongodblog') -%>
quiet = false
<% else -%>
quiet = true
<% end -%>

# fork and run in background
fork = true

bind_ip = 127.0.0.1,<%= node[:ipaddress] %>
port = 27037

dbpath=/data/db/replica1
#slave = true
#source = <%= @mongodbmaster %>

replSet = rdng
<% end -%>
<% if @app_name == "mongod-arbiter" -%>
# Mongod arbiter configuration
pidfilepath = /var/run/mongo/mongod-arbiter.pid
logpath=/var/log/mongo/mongod-arbiter.log

logappend=true

<% if node.attribute?('mongodblog') -%>
quiet = false
<% else -%>
quiet = true
<% end -%>

# fork and run in background
fork = true

bind_ip = <%= node[:ipaddress] %>
port = 30000

dbpath=/data/db/arbiter
replSet = rdng

<% end -%>
<% if @app_name == "mongod-shard" -%>
# Mongod shard configuration
pidfilepath = /var/run/mongo/mongod-arbiter.pid
configdb = <%= @mongodbconfig %>
chunkSize = 64

<% if node.attribute?('mongodblog') -%>
quiet = false
<% else -%>
quiet = true
<% end -%>

<% end -%>
<% if @app_name == "mongod-config" -%>
# Mongod config configuration
pidfilepath = /var/run/mongo/mongod-config.pid
configsvr = true
#where to log
logpath=/var/log/mongo/mongod-config.log

logappend=true

<% if node.attribute?('mongodblog') -%>
quiet = false
<% else -%>
quiet = true
<% end -%>

# fork and run in background
fork = true

bind_ip = <%= node[:ipaddress] %>
port = 27047

dbpath=/data/db/config

<% end -%>

