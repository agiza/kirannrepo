# mongo.conf
# Set Pidfile for daemon processes
pidfilepath = /var/run/mongo/<%= @app_name %>.pid
# Log file location
logpath=/var/log/mongo/<%= @app_name %>.log
# Append log to prevent overwriting logs on restart
logappend=true
# Daemon mode
fork = true
# Check for log level and if not set, log quietly.
<% if node.attribute?('mongodblog') -%>
quiet = false
<% else -%>
quiet = true
<% end -%>
# Begin type specific configuration.
<% if @app_name == "mongod" || @app_name == "mongod-replica" || @app_name == "mongod-replica1" -%>
# Mongod replica configuration

bind_ip = 127.0.01,<%= node[:ipaddress] %>
<% if @app_name == "mongod" -%>
port = 27017
dbpath=/data/db
<% elsif @app_name == "mongod-replica" -%>
port = 27027
dbpath=/data/db/replica
<% elsif @app_name == "mongod-replica1" -%>
port = 27037
dbpath=/data/db/replica1
<% end -%>

replSet = rdng
<% end -%>
<% if @app_name == "mongod-arbiter" -%>
# Mongod arbiter configuration

bind_ip = <%= node[:ipaddress] %>
port = 30000

dbpath=/data/db/arbiter
replSet = rdng

<% end -%>
<% if @app_name == "mongos-mgr" -%>
# Mongod shard configuration
bind_ip = 127.0.0.1,<%= node[:ipaddress] %>
configdb = <%= @mongodbconfig %>
chunkSize = 64

port = 27030


<% end -%>
<% if @app_name == "mongos" -%>
# Mongos configuration
port = 27017
bind_ip = 127.0.0.1,<%= node[:ipaddress] %>
maxConns = 50

configdb = <%= @mongodbconfig %>
chunkSize = 64

<% end -%>
<% if @app_name == "mongod-config" -%>
# Mongod config configuration
configsvr = true

bind_ip = <%= node[:ipaddress] %>
port = 27047

dbpath=/data/db/config

<% end -%>

