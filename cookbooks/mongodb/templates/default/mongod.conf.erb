# mongo.conf
<% if @app_name == "mongod" || @app_name == "mongod-replica" || @app_name == "mongod-replica1" -%>
# Mongod replica configuration
pidfilepath = /var/run/mongo/<%= @app_name.pid
logpath=/var/log/mongo/mongod-<%= @app_name %>.log

logappend=true

<% if node.attribute?('mongodblog') -%>
quiet = false
<% else -%>
quiet = true
<% end -%>

# fork and run in background
fork = true
shardsvr = true

bind_ip = 127.0.01,<%= node[:ipaddress] %>
<% if @app_name == "mongod" -%>
port = 27017
dbpath=/data/db
<% elsif @app_name == "mongod-replica" -%>
port = 27027
dbpath=/data/db/replica
<% elsif @app_name == "mongod-replica1" -%>
port = 27037
dbpath=/data/b/replica1
<% end -%>

replSet = rdng
<% end -%>
<% if @app_name == "mongod-arbiter" -%>
# Mongod arbiter configuration
pidfilepath = /var/run/mongo/mongod-arbiter.pid
logpath=/var/log/mongo/mongod-arbiter.log

logappend=true

<% if node.attribute?('mongodblog') -%>
quiet = false
<% else -%>
quiet = true
<% end -%>

# fork and run in background
fork = true

bind_ip = <%= node[:ipaddress] %>
port = 30000

dbpath=/data/db/arbiter
replSet = rdng

<% end -%>
<% if @app_name == "mongod-shard" -%>
# Mongod shard configuration
pidfilepath = /var/run/mongo/mongod-arbiter.pid
configdb = <%= @mongodbconfig %>
chunkSize = 64

<% if node.attribute?('mongodblog') -%>
quiet = false
<% else -%>
quiet = true
<% end -%>

<% end -%>
<% if @app_name == "mongod-config" -%>
# Mongod config configuration
pidfilepath = /var/run/mongo/mongod-config.pid
configsvr = true
#where to log
logpath=/var/log/mongo/mongod-config.log

logappend=true

<% if node.attribute?('mongodblog') -%>
quiet = false
<% else -%>
quiet = true
<% end -%>

# fork and run in background
fork = true

bind_ip = <%= node[:ipaddress] %>
port = 27047

dbpath=/data/db/config

<% end -%>

