#!/bin/bash
if [ -f /usr/local/bin/replicacreated]; then
  echo "replica already created."
elif [ ! -f /etc/mongo/rsadd.js ]; then
  echo "No rsadd.js file to access"; exit 1
else
  mongo localhost:27017 --quiet /etc/mongo/rsadd.js 
  replicacheck=`mongo localhost:27017 --quiet --eval "printjson(rs.status())" | grep name | wc -l`
  if [ "$replicacheck" -eq 3 ]; then
    touch /usr/local/sbin/replicacreated; exit 0
  else
    echo "Error creating the replicaset."; exit 1
  fi
fi

